<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Flashcards</title>

<link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">

<style>
  body{
    margin:0;
    background:#0f0f0f;
    color:#fff;
    font-family:'Patrick Hand', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
  }
  .app{
    width:100%;
    max-width:480px;
    padding:16px;
    box-sizing:border-box;
  }

  .card{
    background:#000;
    border-radius:16px;
    width:100%;
    aspect-ratio:1/1;
    display:flex;
    justify-content:center;
    align-items:center;
    text-align:center;
    cursor:pointer;
    user-select:none;
    overflow:hidden;
    position:relative;
  }

  .card img{
    width:100%;
    height:100%;
    object-fit:contain;
    display:block;
  }

  .textSide{
    padding:20px;
    font-size:2.5rem;
    line-height:1.15;
  }

  .backControls{
    width:100%;
    padding:14px 14px 16px;
    box-sizing:border-box;
    display:flex;
    justify-content:center;
    align-items:center;
    gap:10px;
    background:#0f0f0f;
  }

  .backControls.hidden{ display:none; }

  audio{
    width:100%;
    max-width:320px;
    height:34px;
  }

  .controlsRow{
    display:flex;
    gap:12px;
    margin-top:14px;
  }

  button{
    flex:1;
    font-family:inherit;
    font-size:1.2rem;
    padding:14px 10px;
    border-radius:12px;
    border:none;
    background:#f1f1f1;
    color:#000;
    cursor:pointer;
  }
  button:active{ transform:scale(0.97); }
</style>
</head>

<body>
<div class="app">
  <div class="card" id="card"></div>

  <!-- Back-side play control (only visible when flipped) -->
  <div class="backControls hidden" id="backControls">
    <audio id="audioBack" controls>
      <source id="audioBackSource" src="" type="audio/mpeg">
      Your browser does not support the audio element.
    </audio>
  </div>

  <!-- Bottom buttons -->
  <div class="controlsRow">
    <button id="prev" type="button">⏪</button>
    <button id="flipPlay" type="button">▶</button>
    <button id="next" type="button">⏩</button>
  </div>

  <!-- Hidden audio used only for the middle button (image side only) -->
  <audio id="audioFront" preload="auto"></audio>
</div>

<script>
const cards = [
  {
    image: "https://i.postimg.cc/Wbg2JhR4/go-to-the-shop.webp",
    audio: "https://res.cloudinary.com/dugvo3tsb/video/upload/v1769842638/go_to_the_shop_rp5pux.wav",
    text: "go to the shop"
  },
  {
    image: "https://i.postimg.cc/c4ws8rqr/play-the-guitar.webp",
    audio: "https://res.cloudinary.com/dugvo3tsb/video/upload/v1769842638/play_the_guitar_mz3asa.wav",
    text: "play the guitar"
  },
  {
    image: "https://i.postimg.cc/tCWXVY07/read-a-newspaper.webp",
    audio: "https://res.cloudinary.com/dugvo3tsb/video/upload/v1769842638/read_a_newspaper_ew6nxj.wav",
    text: "read a newspaper"
  },
  {
    image: "https://i.postimg.cc/DyL2b8VX/surf-the-internet.webp",
    audio: "https://res.cloudinary.com/dugvo3tsb/video/upload/v1769842638/surf_the_internet_grtqm1.wav",
    text: "surf the internet"
  },
  {
    image: "https://i.postimg.cc/4NVJhmCy/use-the-phone.webp",
    audio: "https://res.cloudinary.com/dugvo3tsb/video/upload/v1769842638/use_the_phone_eaksen.wav",
    text: "use the phone"
  },
  {
    image: "https://i.postimg.cc/7Y0xTfvT/write-a-story.webp",
    audio: "https://res.cloudinary.com/dugvo3tsb/video/upload/v1769842638/write_a_story_g7kd5t.wav",
    text: "write a story"
  }
];

let index = 0;
let flipped = false;

const cardEl = document.getElementById("card");
const backControlsEl = document.getElementById("backControls");

const audioFront = document.getElementById("audioFront");
const audioBack = document.getElementById("audioBack");
const audioBackSource = document.getElementById("audioBackSource");

function stopAllAudio(){
  audioFront.pause();
  audioFront.currentTime = 0;

  audioBack.pause();
  try { audioBack.currentTime = 0; } catch (e) {}
}

function render(){
  // Always return to image side on navigation
  flipped = false;
  backControlsEl.classList.add("hidden");

  // Stop audio any time we change cards
  stopAllAudio();

  // Render image side
  cardEl.innerHTML = `<img src="${cards[index].image}" alt="">`;

  // Set both audio elements to the correct file
  audioFront.src = cards[index].audio;
  audioFront.load();

  audioBackSource.src = cards[index].audio;
  audioBack.load();
}

function showTextSide(){
  flipped = true;
  cardEl.innerHTML = `<div class="textSide">${cards[index].text}</div>`;
  backControlsEl.classList.remove("hidden");
}

function showImageSide(){
  flipped = false;
  backControlsEl.classList.add("hidden");
  cardEl.innerHTML = `<img src="${cards[index].image}" alt="">`;
}

function prevCard(){
  index = (index - 1 + cards.length) % cards.length;
  render();
}

function nextCard(){
  index = (index + 1) % cards.length;
  render();
}

/*
  Middle button behavior:
  - Only works from IMAGE side.
  - When pressed: plays audio AND flips to text side.
  - When already flipped (text showing): DO NOT play audio, do nothing.
*/
async function flipAndPlay(){
  if (flipped) return; // do not allow audio while text is showing

  // Start audio immediately
  try {
    audioFront.currentTime = 0;
    await audioFront.play();
  } catch (e) {
    // If autoplay is blocked for some reason, it still flips.
  }

  // Flip to text side
  showTextSide();
}

// Clicking the card itself should NOT play audio.
// Optional: tap card to flip back to image side only.
cardEl.addEventListener("click", () => {
  if (flipped) {
    // When text is showing, tap card returns to image side and stops audio.
    stopAllAudio();
    showImageSide();
  }
  // If image is showing, tapping the card does nothing.
});

// Buttons
document.getElementById("prev").addEventListener("click", prevCard);
document.getElementById("next").addEventListener("click", nextCard);
document.getElementById("flipPlay").addEventListener("click", flipAndPlay);

// Safety: if back-side audio starts, immediately stop it (enforces your rule)
audioBack.addEventListener("play", () => {
  // You said: "I don't want to be able to hear the audio with the text showing"
  // So we block audio playback on the text side entirely.
  audioBack.pause();
  try { audioBack.currentTime = 0; } catch (e) {}
});

render();
</script>
</body>
</html>
