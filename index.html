<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Flashcards</title>

<link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">

<style>
  * { box-sizing: border-box; }

  body{
    margin:0;
    background:#0f0f0f;
    color:#fff;
    font-family:'Patrick Hand', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    min-height:100vh;

    /* SHIFT EVERYTHING UP */
    display:flex;
    justify-content:center;
    align-items:flex-start; /* <-- top, not center */
  }

  .app{
    width:100%;
    max-width:480px;
    padding:10px 16px 16px;  /* less top padding */
  }

  .card{
    background:#000;
    border-radius:16px;
    width:100%;
    aspect-ratio:1/1;
    display:flex;
    justify-content:center;
    align-items:center;
    text-align:center;
    cursor:pointer;
    user-select:none;
    overflow:hidden;
  }

  .card img{
    width:100%;
    height:100%;
    object-fit:contain;
    display:block;
  }

  .textSide{
    padding:20px;
    font-size:2.5rem;
    line-height:1.15;
  }

  .controlsRow{
    display:flex;
    gap:12px;
    margin-top:12px;
  }

  .controlsRow button{
    flex:1;
  }

  .shuffleRow{
    margin-top:12px;
  }
  .shuffleRow button{
    width:100%;
  }

  button{
    font-family:inherit;
    font-size:1.2rem;
    padding:14px 10px;
    border-radius:12px;
    border:none;
    background:#f1f1f1;
    color:#000;
    cursor:pointer;
  }

  button:active{ transform:scale(0.97); }

  /* Back-side play control row */
  .backControls{
    width:100%;
    margin-top:10px;
    display:flex;
    justify-content:center;
    align-items:center;
  }
  .backControls.hidden{ display:none; }

  audio{
    width:100%;
    max-width:320px;
    height:34px;
  }

  /* Slightly tighten on small phones */
  @media (max-width:420px){
    .app{ padding-top:8px; }
    button{ padding:13px 10px; }
  }
</style>
</head>

<body>
<div class="app">

  <div class="card" id="card"></div>

  <!-- Visible ONLY when flipped. You requested it exists, but NO sound should play while text is showing. -->
  <div class="backControls hidden" id="backControls">
    <audio id="audioBack" controls>
      <source id="audioBackSource" src="" type="audio/mpeg">
      Your browser does not support the audio element.
    </audio>
  </div>

  <!-- Row 1: Prev / Flip+Play / Next (double arrows as requested) -->
  <div class="controlsRow">
    <button id="prev" type="button"><<</button>
    <button id="flipPlay" type="button">â–¶</button>
    <button id="next" type="button">>></button>
  </div>

  <!-- Row 2: Shuffle (separate row, as you liked before) -->
  <div class="shuffleRow">
    <button id="shuffle" type="button">ðŸ”€ Shuffle</button>
  </div>

  <!-- Hidden front audio used for the image-side flip+play -->
  <audio id="audioFront" preload="auto"></audio>
</div>

<script>
const cards = [
  {
    image: "https://i.postimg.cc/Wbg2JhR4/go-to-the-shop.webp",
    audio: "https://res.cloudinary.com/dugvo3tsb/video/upload/v1769842638/go_to_the_shop_rp5pux.wav",
    text: "go to the shop"
  },
  {
    image: "https://i.postimg.cc/c4ws8rqr/play-the-guitar.webp",
    audio: "https://res.cloudinary.com/dugvo3tsb/video/upload/v1769842638/play_the_guitar_mz3asa.wav",
    text: "play the guitar"
  },
  {
    image: "https://i.postimg.cc/tCWXVY07/read-a-newspaper.webp",
    audio: "https://res.cloudinary.com/dugvo3tsb/video/upload/v1769842638/read_a_newspaper_ew6nxj.wav",
    text: "read a newspaper"
  },
  {
    image: "https://i.postimg.cc/DyL2b8VX/surf-the-internet.webp",
    audio: "https://res.cloudinary.com/dugvo3tsb/video/upload/v1769842638/surf_the_internet_grtqm1.wav",
    text: "surf the internet"
  },
  {
    image: "https://i.postimg.cc/4NVJhmCy/use-the-phone.webp",
    audio: "https://res.cloudinary.com/dugvo3tsb/video/upload/v1769842638/use_the_phone_eaksen.wav",
    text: "use the phone"
  },
  {
    image: "https://i.postimg.cc/7Y0xTfvT/write-a-story.webp",
    audio: "https://res.cloudinary.com/dugvo3tsb/video/upload/v1769842638/write_a_story_g7kd5t.wav",
    text: "write a story"
  }
];

let index = 0;
let flipped = false;

const cardEl = document.getElementById("card");
const backControlsEl = document.getElementById("backControls");

const audioFront = document.getElementById("audioFront");
const audioBack = document.getElementById("audioBack");
const audioBackSource = document.getElementById("audioBackSource");

function stopAllAudio(){
  audioFront.pause();
  audioFront.currentTime = 0;

  audioBack.pause();
  try { audioBack.currentTime = 0; } catch (e) {}
}

function showImageSide(){
  flipped = false;
  backControlsEl.classList.add("hidden");
  cardEl.innerHTML = `<img src="${cards[index].image}" alt="">`;
}

function showTextSide(){
  flipped = true;
  cardEl.innerHTML = `<div class="textSide">${cards[index].text}</div>`;
  backControlsEl.classList.remove("hidden");
}

function render(){
  flipped = false;
  stopAllAudio();

  // Set both audio elements to the correct file
  audioFront.src = cards[index].audio;
  audioFront.load();

  audioBackSource.src = cards[index].audio;
  audioBack.load();

  showImageSide();
}

async function flipAndPlay(){
  if (flipped) return; // do nothing if text is showing (prevents audio-on-text)

  // play audio immediately (image side only)
  try{
    audioFront.currentTime = 0;
    await audioFront.play();
  }catch(e){
    // if blocked, still flip
  }

  // flip to text
  showTextSide();
}

/* Clicking the IMAGE should do the same as the middle button:
   flip + play immediately.
   Clicking the TEXT does nothing (and audio is blocked anyway). */
cardEl.addEventListener("click", () => {
  if (!flipped) {
    flipAndPlay();
  }
});

function prevCard(){
  index = (index - 1 + cards.length) % cards.length;
  render();
}

function nextCard(){
  index = (index + 1) % cards.length;
  render();
}

function shuffleCard(){
  index = Math.floor(Math.random() * cards.length);
  render();
}

// Button bindings
document.getElementById("prev").addEventListener("click", prevCard);
document.getElementById("next").addEventListener("click", nextCard);
document.getElementById("flipPlay").addEventListener("click", flipAndPlay);
document.getElementById("shuffle").addEventListener("click", shuffleCard);

// Enforce: no audible audio while text is showing
audioBack.addEventListener("play", () => {
  audioBack.pause();
  try { audioBack.currentTime = 0; } catch (e) {}
});

render();
</script>
</body>
</html>
